/*! qding - v0.1.0 - * Copyright (c) 2014 lovemoon@yeah.net; Licensed GPLv2 */
!function(){var a={modules:[],register:function(a,b,c){return this.modules.push(a),angular.module(a,b,c)},generator:function(a){var b=angular.module(a),c=a.replace(/Module$/,"")+"Service";b.factory(c,function(a){return a()})}},b=angular.module("app",["ui.router","ui.bootstrap","angular-growl","templates"]);angular.element(document).ready(function(){angular.bootstrap(document,a.modules)}),String(this).replace(/[A-Z]/g,function(a){return"-"+a.charAt(0)}),function(){for(var a,b=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)}(),function(){"function"!=typeof Array.prototype.indexOf&&(Array.prototype.indexOf=function(a){for(var b=0;b<this.length;b++)if(this[b]===a)return b;return-1}),"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})}(),function(){var a=function(){var a=3,b=document.createElement("div"),c=b.getElementsByTagName("i");do b.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->";while(c[0]);return a>4?a:!1}();if(a){var b=0;!function c(){var d=document.getElementsByTagName("html")[0];d?d.className+=" ie ie"+a:b++<2&&setTimeout(c,200)}()}}();var c=function(a){var b,d,e,f,g,h,i,j="";for(b in a)if(a.hasOwnProperty(b))if(d=a[b],d instanceof Array)for(i=0;i<d.length;++i)g=d[i],e=b,h={},h[e]=g,j+=c(h)+"&";else if(d instanceof Object)for(f in d)d.hasOwnProperty(f)&&(g=d[f],e=b+"["+f+"]",h={},h[e]=g,j+=c(h)+"&");else void 0!==d&&null!==d&&(j+=encodeURIComponent(b)+"="+encodeURIComponent(d)+"&");return j.length?j.substr(0,j.length-1):j};b.config(["$sceProvider",function(a){a.enabled(!1)}]),b.config(["datepickerConfig","datepickerPopupConfig",function(a,b){a.showWeeks=!1,b.showButtonBar=!1}]),b.config(["growlProvider",function(a){a.onlyUniqueMessages(!0),a.globalTimeToLive(4e3),a.globalEnableHtml(!1)}]),b.config(["paginationConfig",function(a){a.directionLinks=!0,a.boundaryLinks=!0,a.maxSize=10,a.firstText="首页",a.lastText="尾页",a.previousText="上一页",a.nextText="下一页"}]),b.config(["$httpProvider",function(a){a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8",a.defaults.transformRequest=[function(a){return angular.isObject(a)&&"[object File]"!==String(a)?c(a):a}],a.interceptors.push(["$q","growl","$rootScope",function(a,b,c){return{request:function(b){var c=b.url.match(/:(\w+)/g);return null!==c&&angular.forEach(c,function(a){var c=a.substring(1);b.params&&b.params.hasOwnProperty(c)?(b.url=b.url.replace(a,b.params[c]),delete b.params[c]):b.data&&b.data.hasOwnProperty(c)&&(b.url=b.url.replace(a,b.data[c]),delete b.data[c])}),a.when(b)},response:function(b){if(angular.isObject(b.data)){var d=b.data;return d.data=d.data||{},(d.data.message||d.message)&&(d.data.message=d.data.message||d.message),(401===d.code||"login"===b.data.__ajax__error__back)&&(c.USER=null,c.$emit("loginRequired")),b.config.$parsing!==!1?-1!==[0,200].indexOf(d.code)?d.data:a.reject(d.data):a.when(b.data)}return a.when(b)},requestError:function(c){return b.addErrorMessage("请求异常，请刷新重试！",{ttl:-1}),a.reject(c)},responseError:function(c){return b.addErrorMessage("服务器异常，请刷新重试！",{ttl:-1}),a.reject(c)}}}])}]),b.run(["$rootScope",function(a){var b=document.createElement("a");b.setAttribute("href",document.querySelector('link[rel="stylesheet"]').getAttribute("href")),a.$host=b.protocol+"//"+b.host}]),b.run(["$rootScope",function(a){var b=["account.login","account.logout"];a.$on("$stateChangeStart",function(c,d){a.USER={},a.$layout=-1===b.indexOf(d.name)})}]),b.value("menubar",[{menus:[{href:"#account/member",name:"用户管理",id:8000201e3},{href:"#account/role",name:"角色管理",id:8000202e3},{href:"",name:"菜单配置",id:8000203e3}],id:8000000200,name:"账户管理"},{id:8000000600,name:"团购管理",menus:[{href:"/market/#/market/providerType",name:"供方类型",id:8000709001},{href:"/market/#/market/provider",name:"供应商",id:8000709002},{href:"/market/#/market/appChannel",name:"APP频道",id:8000709003},{href:"/market/#/market/goodsCategory",name:"商品品类",id:8000709004},{href:"/market/#/market/goods",name:"商品管理",id:8000709005},{href:"/market/#/market/goodsSpecification",name:"规格管理",id:8000709006},{href:"/market/#/market/recommend",name:"推荐管理",id:8000709016}]}]),b.directive("csLayout",["$rootScope",function(a){return{restrict:"A",replace:!1,transclude:!0,templateUrl:"config/templates/layout.partial.html",link:function(b,c){a.$on("$stateChangeStart",function(a,b){var d=b.name.replace(/[._]/g,"-").replace(/([A-Z])/g,"-$1").toLowerCase();c.attr("class",d)})}}}]),b.directive("csMenubar",["$rootScope","$state","menubar",function(a,b,c){return{restrict:"A",replace:!1,templateUrl:"config/templates/menubar.partial.html",link:function(d){d.menubar=c,d.toggleMenu=function(a){angular.forEach(c,function(b){b!==a&&(b.active=!1)}),a.active=!a.active};var e=function(a){angular.forEach(c,function(b){for(var c=0;c<b.menus.length;c++)b.menus[c].sref===a&&(b.active=!0)})};if(b.current&&b.current.name)e(b.current.name);else var f=a.$on("$stateChangeSuccess",function(a,b){e(b.name),f()})}}}]),b.directive("csFocus",["$timeout",function(a){return{restrict:"A",replace:!1,link:function(b,c){var d=0;!function e(){c.is(":visible")?c.focus():d++<1&&a(e,200)}()}}}]),b.directive("csAutofill",["$timeout",function(a){return{require:"^ngModel",link:function(b,c,d,e){var f=0,g=null,h=c.val();!function i(){c.val()!==h?(e.$setViewValue(c.val()),c.focus()):f++<3&&(a.cancel(g),g=a(i,200))}(),b.$on("$destroy",function(){a.cancel(g)})}}}]),b.directive("csCheckbox",function(){return{restrict:"A",replace:!1,scope:{list:"=",fill:"=",label:"@",value:"@"},templateUrl:"config/templates/checkbox.partial.html",link:function(a){a.fill=a.fill||[],a.toggleValue=function(b){var c=a.fill.indexOf(b);c>-1?a.fill.splice(c,1):a.fill.push(b)}}}}),b.directive("csSelect",["$timeout","$http",function(a,b){return{restrict:"A",replace:!0,scope:{associate:"=",url:"@",key:"@",label:"@",blank:"@",type:"@",params:"=",sname:"@",required:"@",change:"&"},templateUrl:function(){return"config/templates/select.partial.html"},link:function(c){c.$key=c.key||"id",c.$label=c.label||"name",c.$blank=angular.isUndefined(c.blank)?"请选择":c.blank,c.url&&b({url:c.url,params:c.params}).then(function(b){c.list=b.list,"false"===c.$blank&&b.list.length>0&&c.associate!==b.list[0][c.key]&&(c.associate=b.list[0][c.key],a(function(){c.change()},50))})}}}]),b.filter("group",function(){return function(a,b){if(!a)return a;if(a.$rows){for(var c=[],d=0;d<a.$rows.length;d++)c=c.concat(a.$rows[d]);if(c.length!==a.length)delete a.$rows;else for(var e=0;e<a.length;e++)if(a[e]!==c[e]){delete a.$rows;break}}if(!a.$rows){for(var f=[],g=0;g<a.length;g++)g%b===0&&f.push([]),f[f.length-1].push(a[g]);a.$rows=f}return a.$rows}}),b.filter("empty",function(){return function(a){return!a||angular.equals({},a)||angular.equals([],a)}}),b.filter("min",function(){return function(a,b){return Math.min(a,b)}}),b.filter("max",function(){return function(a,b){return Math.max(a,b)}}),b.filter("safe",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),b.filter("status",function(){return function(a,b){return/^\d$/.test(a)?(a=b?~a+2:a,0===a?"停用":"启用"):(a=b?"stopped"===a?"using":"stopped":a,"stopped"===a?"停用":"启用")}}),b.filter("is",function(){return function(a,b){return b=angular.isUndefined(b)?!0:b,a=b?a:!a,a?"是":"否"}}),b.factory("serviceGenerator",["$http","$injector",function(a,b){return function(){var c={},d=function(b,d,e,f){var g=c[b];if(!g)throw new Error("<< "+b+" method action not config >>");return a({url:g,params:d||null,data:e||null,method:f?f:"query"===b?"get":"post"})},e=function(a){return angular.isObject(a)?a.id:a},f={query:function(a){return d("query",a,null)},create:function(a){return d("create",null,a)},update:function(a){return d("update",null,a)},remove:function(a){return d("remove",null,e(a))},toggle:function(a){return d("toggle",null,{id:e(a),status:0===a.status?1:0})},get:function(b,c){return a({url:b,params:c})},post:function(b,c){return a({url:b,data:c})},$actions:function(){return angular.extend(c,arguments[0]),angular.forEach(arguments[0],function(b,c){"string"!=typeof b&&(f[c]=function(){return a(b.method&&"get"===b.method.toLowerCase()?{url:b.url,params:arguments[0]}:{url:b.url,data:arguments[0],method:"post"})})}),this},$methods:function(){return angular.forEach(b.invoke(arguments[0]),function(a,b){f[b]=a.bind(f)}),this}};return f}}]),b.factory("controllerGenerator",["$q","$injector","$modal","growl",function(a,b,c,d){return function(b,e,f){return b.page=1,b.size=20,b.query=function(c){c!==!0&&(b.list=[],b.loading=!0);var f=angular.extend({page:b.page,size:b.size},c);return e.query(f).then(function(c){return b.list=c.list,b.page=c.page,b.size=c.size,b.total=c.total,a.when(c)},function(b){return d.addErrorMessage(b.message||"服务器异常，请稍后再试！"),a.reject(b)})["finally"](function(){b.loading=!1})},b.create=function(){c.open({templateUrl:f.createTemplate,controller:["$scope",function(c){c.title="添加"+f.title,c.entity={},c.confirm=function(){c.creating=!0,e.create(c.entity).then(function(e){return b.query(),d.addSuccessMessage(c.title+"成功！"),a.when(e)},function(b){return d.addErrorMessage(b.message||c.title+"失败！"),a.reject(b)})["finally"](function(){c.creating=!1,c.$close()})}}]})},b.update=function(b){c.open({templateUrl:f.updateTemplate||f.modifyTemplate,controller:["$scope",function(c){c.title="编辑"+f.title,c.entity=angular.copy(b),c.confirm=function(){c.updating=!0,e.update(c.entity).then(function(e){return angular.extend(b,e.entity||c.entity),d.addSuccessMessage(c.title+"成功!"),a.when(e)},function(b){return d.addErrorMessage(b.message||c.title+"失败！"),a.reject(b)})["finally"](function(){c.updating=!1,c.$close()})}}]})},b.remove=function(g){c.open({templateUrl:"config/templates/delete.partial.html",controller:["$scope",function(c){c.title="删除"+f.title,c.entity=g,c.message="<h4>您确定要删除"+f.title+' ( <span class="text-warning">'+g[f.property||"name"]+"</span> ) 吗？</h4>",c.confirm=function(){g.deleting=!0,e.remove(g).then(function(e){return b.total-=1,b.list.splice(b.list.indexOf(g),1),b.list.length<2*(b.size||20)/3&&b.query(!0),d.addSuccessMessage(c.title+"成功!"),a.when(e)},function(a){d.addErrorMessage(a.message||c.title+"失败！")})["finally"](function(){g.deleting=!1}),c.$close()}}]})},b.toggle=function(b){b.toggling=!0,e.toggle(b).then(function(c){return b.status=0===b.status?1:0,d.addSuccessMessage("操作成功!"),a.when(c)},function(b){return d.addErrorMessage(b.message||"操作失败！"),a.reject(b)})["finally"](function(){b.toggling=!1})},b["delete"]=function(a){return b.remove(a)},b.modify=function(a){return b.update(a)},f.autoload&&b.query(),b}}]),b.factory("bootbox",["$modal",function(a){return{alert:function(b,c){a.open({templateUrl:"common/templates/bootbox.partial.html",controller:["$scope",function(a){a.type="alert",a.message=b,a.confirm=function(){return a.$close(),c&&c()}}]})},confirm:function(b,c){a.open({templateUrl:"common/templates/bootbox.partial.html",controller:["$scope",function(a){a.type="confirm",a.message=b,a.confirm=function(){return a.$close(),c&&c()}}]})}}}]);var d=a.register("welcomeModule",["app"]);d.config(["$stateProvider","$urlRouterProvider",function(a,b){b.otherwise("/welcome"),a.state("welcome",{url:"/welcome",templateUrl:"modules/welcome/templates/welcome.html",controller:"welcomeController"})}]),d.controller("welcomeController",["$scope","$state","growl",function(){}]),angular.module("templates",["config/templates/bootbox.partial.html","config/templates/checkbox.partial.html","config/templates/confirm.partial.html","config/templates/delete.partial.html","config/templates/layout.partial.html","config/templates/menubar.partial.html","config/templates/select.partial.html","modules/welcome/templates/welcome.html"]),angular.module("config/templates/bootbox.partial.html",[]).run(["$templateCache",function(a){a.put("config/templates/bootbox.partial.html",'<div class="modal-body" ng-bind-html="message|safe"></div><div class="modal-footer"><button class="btn btn-primary" ng-click="confirm()">确定</button> <button class="btn btn-default" ng-click="$dismiss()" ng-if="type === \'confirm\'">取消</button></div>')}]),angular.module("config/templates/checkbox.partial.html",[]).run(["$templateCache",function(a){a.put("config/templates/checkbox.partial.html",'<label class="checkbox-inline text-overflow" ng-repeat="item in list" title="{{ item[label] }}"><input type="checkbox" value="{{ item[value] }}" ng-checked="fill.indexOf(item[value]) > -1" ng-click="toggleValue(item[value])"> {{ item[label] }}</label>')}]),angular.module("config/templates/confirm.partial.html",[]).run(["$templateCache",function(a){a.put("config/templates/confirm.partial.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()">&times;</a><h4 class="modal-title">{{ title }}</h4></div><div class="modal-body" ng-bind-html="message|safe"></div><div class="modal-footer"><button class="btn btn-primary" ng-click="confirm()" ng-disabled="processing">{{ confirmText || \'确定\' }}</button> <button class="btn btn-default" ng-click="$dismiss()">取消</button></div>')}]),angular.module("config/templates/delete.partial.html",[]).run(["$templateCache",function(a){a.put("config/templates/delete.partial.html",'<div class="modal-header"><a class="close" ng-click="$dismiss()">&times;</a><h4 class="modal-title">{{ title }}</h4></div><div class="modal-body" ng-bind-html="message|safe"></div><div class="modal-footer"><button class="btn btn-danger" ng-click="confirm()" ng-disabled="item.deleting">{{ confirmText || \'删除\' }}</button> <button class="btn btn-default" ng-click="$dismiss()">取消</button></div>')}]),angular.module("config/templates/layout.partial.html",[]).run(["$templateCache",function(a){a.put("config/templates/layout.partial.html",'<div ng-if="!$layout" ui-view></div><div ng-if="$layout &amp;&amp; USER"><header id="header"><div class="container-fluid"><a href="/" class="brand link-white pull-left"><img ng-src="{{ $host }}/server/images/logo.png" class="logo" alt="千丁互联"> 千丁互联</a><div class="settings pull-right"><span class="dropdown"><a class="dropdown-toggle link-white" href=""><span class="text-right name">{{ USER.nick }}</span> <span class="caret"></span></a><ul class="dropdown-menu pull-right"><li><a ui-sref="account.settings"><i class="fa fa-cog text-muted"></i> 设置</a></li><li><a ui-sref="account.logout"><i class="fa fa-power-off text-muted"></i> 退出</a></li></ul></span></div></div></header><section id="content"><div class="container-fluid"><div growl></div><div class="row"><div class="sidebar col-sm-2 col-md-2"><div cs-menubar></div></div><div class="main col-sm-10 col-md-10" ui-view></div></div></div></section><footer id="footer"></footer></div>')}]),angular.module("config/templates/menubar.partial.html",[]).run(["$templateCache",function(a){a.put("config/templates/menubar.partial.html",'<ul class="menus list-unstyled"><li><a ui-sref="home"><i class="fa fa-home"></i>菜单导航{{ $location.hash }}</a></li><li ng-repeat="item in menubar" ng-click="toggleMenu(item)" ng-class="{active: item.active}"><a href=""><i class="fa fa-cog"></i>{{ item.name }} <i class="fa pull-right" ng-class="{\'fa-angle-right\': !item.active, \'fa-angle-down\': item.active}"></i></a><ul class="sub-menu list-unstyled" ng-click="$event.stopPropagation()"><li ng-repeat="menu in item.menus" ui-sref-active="active"><a ng-href="{{ menu.href }}">{{ menu.name }}</a></li></ul></li></ul>')}]),angular.module("config/templates/select.partial.html",[]).run(["$templateCache",function(a){a.put("config/templates/select.partial.html",'<select class="form-control" ng-model="associate" name="{{ sname }}" ng-required="{{ required }}" ng-change="change()"><option value="" ng-if="$blank !== \'false\'">{{ $blank }}</option><option ng-repeat="item in list" value="{{ item[$key] }}">{{ item[$label] }}</option></select>')}]),angular.module("modules/welcome/templates/welcome.html",[]).run(["$templateCache",function(a){a.put("modules/welcome/templates/welcome.html",'<img ng-src="{{ $host }}/server/images/logo.png" class="welcome flipInY animated">')}])}();